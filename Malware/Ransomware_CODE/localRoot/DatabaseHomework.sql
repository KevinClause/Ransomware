CREATE DATABASE DatabaseHomework;
USE DatabaseHomework;

CREATE TABLE SUBJECT_INFO (
	s_id INT NOT NULL,
    s_firstname VARCHAR(255) NOT NULL,
    s_lastname VARCHAR(255),
    s_age INT,
    s_country VARCHAR(255),
    PRIMARY KEY (s_id)
);

CREATE TABLE ANSWER (
	a_id INT NOT NULL,
    s_id INT NOT NULL,
    a_serveyNum INT NOT NULL,
    a_surveyDate VARCHAR(255),
    a_q1 INT,
    a_q2 INT,
    a_q3 INT,
    a_q4 INT,
    a_q5 INT,
    a_q6 INT,
    a_q7 INT,
    a_q8 INT,
    PRIMARY KEY (a_id),
    FOREIGN KEY (s_id) REFERENCES SUBJECT_INFO(s_id)
);

SELECT * FROM SUBJECT_INFO;

SELECT distinct s_firstname, s_lastname FROM SUBJECT_INFO 
INNER JOIN ANSWER USING(s_id) WHERE answer.a_serveyNum >=1 order by s_lastname ASC;

SELECT distinct s_firstname, s_lastname FROM SUBJECT_INFO 
INNER JOIN ANSWER USING(s_id) WHERE answer.a_serveyNum = 3 order by subject_info.s_age desc;

SELECT a_id, a_q1, (6 - a_q2) as a_q2, a_q3, (6 - a_q4) as a_q4, a_q5, 
(6 - a_q6) as a_q6, a_q7, (6 - a_q8) as a_q8 FROM answer;

SELECT a_id, avg(a_q1 + a_q3 + a_q4 + a_q5) FROM answer;

SELECT a_id, ((a_q1 + a_q3 + (6 - a_q4) + a_q5)/ 4) as construct_1, 
((a_q1 + (6 - a_q2) + a_q3 + (6 - a_q4))/ 4) as construct_2 FROM answer;

SELECT a_id, (((a_q1 + a_q3 + (6 - a_q4) + a_q5)/ 4) / a_serveyNum) as construct_1, 
(((a_q1 + (6 - a_q2) + a_q3 + (6 - a_q4))/ 4) / a_serveyNum) as construct_2 FROM answer;

SELECT * FROM ANSWER;

DROP TABLE IF EXISTS SUBJECT_INFO;

DROP TABLE IF EXISTS ANSWER;
